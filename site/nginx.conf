worker_processes auto;

events {
    worker_connections 1024;
}

http {
    include       mime.types;
    default_type  application/octet-stream;

    # Enable gzip compression for text-based assets
    gzip on;
    gzip_comp_level 6;
    gzip_min_length 1024;
    gzip_vary on;
    gzip_proxied any;
    gzip_types text/plain text/css application/javascript application/json application/xml application/rss+xml text/javascript image/svg+xml;

    sendfile        on;
    keepalive_timeout 65;

    server {
        listen       80;
        server_name  localhost;

        root   V:/vodkakazonline;
        index  index.html index.htm;

        location / {
            # Hint the browser to preload the main stylesheet and preconnect to Wikimedia asset origin
            add_header Link "</styles.min.css>; rel=preload; as=style" always;
            add_header Link "<https://upload.wikimedia.org>; rel=preconnect; crossorigin" always;
            try_files $uri $uri/ =404;
        }

        location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|webp|json)$ {
            expires 7d;
            add_header Cache-Control "public";
        }

        error_page 404 /404.html;

        # Service Worker
        location /sw.js {
            add_header Cache-Control "no-cache";
        }

        # Logs
        access_log V:/vodkakazonline/etc/nginx/nginx-1.28.0/logs/access.log;
        error_log V:/vodkakazonline/etc/nginx/nginx-1.28.0/logs/error.log;
    }
}
